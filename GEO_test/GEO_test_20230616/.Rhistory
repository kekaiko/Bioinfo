setwd("D:\\Study\\Shanghaitech1\\Rotation4\\Bioinfo\\GEO_test\\GEO_test_20230616")
suppressPackageStartupMessages(library(GEOquery))  #屏蔽加载的红字
gset <- getGEO("GSE162903",destdir = ".",
# AnnotGPL = F,
# getGPL = F,   #这两行用于避免下载注释文件，太大了
)
downGSE <- function(studyID = "GSE1009", destdir = ".") {
library(GEOquery)
eSet <- getGEO(studyID, destdir = destdir)
exprSet = exprs(eSet[[1]])
pdata = pData(eSet[[1]])
write.csv(exprSet, paste0(studyID, "_exprSet.csv"))
write.csv(pdata, paste0(studyID, "_metadata.csv"))
return(eSet)
}
downGSE(studyID = "GSE162903")
exprSet <- read.csv("GSE162903_exprSet.csv",header = T,row.names = 1)
pdata <- read.csv("GSE162903_metadata.csv",header = T,row.names = 1)
View(exprSet)
View(pdata)
a <- read.table("GSE162903_series_matrix.txt.gz",comment.char = "!",header = T,sep = "\t",fill = T)
View(a)
a <- read.table("GSE162903_series_matrix.txt.gz",header = T,sep = "\t",fill = T)
View(a)
a <- read.table("GSE162903_series_matrix.txt.gz",comment.char = "!",header = T,fill = T)
View(a)
a <- read.table("GSE162903_series_matrix.txt.gz",comment.char = "!",header = T,sep = "\t")
View(a)
# head(a)
exprSet <- read.csv("GSE162903_RNA_counts_filtered_matrix.csv.gz",header = T,row.names = 1)
View(a)
View(exprSet)
View(exprSet)
View(pdata)
View(exprSet)
dim(exprSet)
head(exprSet)
